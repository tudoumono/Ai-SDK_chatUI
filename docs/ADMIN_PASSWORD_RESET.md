# 管理者パスワードリセット手順

このドキュメントでは、Tauri版（exe）で管理者パスワードを忘れた場合のリセット手順を説明します。

## 概要

ファイルベースのパスワードリセット機能を使用して、物理的なアクセス権限を持つユーザーのみがパスワードをリセットできます。

## セキュリティ上の注意

- ✅ **物理的なアクセスが必要**: ファイルを配置するため、PCへの直接アクセスが必要
- ✅ **組織設定を保持**: パスワードのみがリセットされ、組織ホワイトリストなどは保持される
- ✅ **自動削除**: リセット成功後、ファイルは自動的に削除されるため悪用されにくい
- ⚠️ **平文保存**: リセットファイルにはパスワードが平文で保存されるため、リセット後は速やかに削除されます

## リセット手順

### 方法1: バッチファイルを使用（Windows - 推奨）

1. **リセットファイル作成ツールを実行**
   ```batch
   cd scripts
   create-password-reset-file.bat MyNewPassword123
   ```

2. **アプリケーションを起動**
   - exeファイルをダブルクリックして起動

3. **管理者ログイン画面でリセット**
   - 「パスワードリセットファイルが検出されました」という通知が表示されます
   - 「パスワードをリセット」ボタンをクリック
   - 確認ダイアログで「OK」を選択

4. **新しいパスワードでログイン**
   - ページが自動的にリロードされます
   - 新しいパスワードでログインしてください

### 方法2: Node.jsスクリプトを使用（クロスプラットフォーム）

1. **リセットファイル作成スクリプトを実行**
   ```bash
   node scripts/create-password-reset-file.js MyNewPassword123
   ```

2. **アプリケーションを起動**してリセット（方法1と同じ）

### 方法3: 手動でファイルを作成

高度なユーザー向けの手動作成方法です。

1. **リセットファイルを作成**

   ファイル名: `.admin-password-reset`
   内容: 新しいパスワード（6文字以上）

   例（メモ帳で作成）:
   ```
   MyNewPassword123
   ```

2. **ファイルを配置**

   **Windows:**
   ```
   %APPDATA%\com.tauri.dev\.admin-password-reset
   ```

   **macOS:**
   ```
   ~/Library/Application Support/com.tauri.dev/.admin-password-reset
   ```

   **Linux:**
   ```
   ~/.config/com.tauri.dev/.admin-password-reset
   ```

3. **アプリケーションを起動**してリセット（方法1と同じ）

## トラブルシューティング

### リセットボタンが表示されない

- ファイルが正しい場所に配置されているか確認してください
- ファイル名が `.admin-password-reset` であることを確認してください（ドットで始まる）
- Windowsでは隠しファイルが表示される設定にしてください

### 「リセットファイルが見つかりません」エラー

- アプリケーション起動後にファイルを配置した場合、アプリを再起動してください
- ファイルパスが正しいか確認してください

### 「リセットファイルに有効なパスワードが記載されていません」エラー

- パスワードが6文字以上であることを確認してください
- ファイル内に余分な改行や空白がないか確認してください

### リセット後もログインできない

- 新しいパスワードを正確に入力しているか確認してください
- ブラウザのキャッシュをクリアしてみてください

## よくある質問（FAQ）

### Q: パスワードをリセットすると組織ホワイトリストも消えますか？

A: いいえ、パスワードのみがリセットされます。組織ホワイトリスト、機能制限設定、その他の設定はすべて保持されます。

### Q: ブラウザ版でもこの機能は使えますか？

A: いいえ、この機能はTauri版（exe）専用です。ブラウザ版ではブラウザの開発者ツールを使用してlocalStorageから手動で削除してください。

### Q: リセットファイルを配置したまま放置するとどうなりますか？

A: セキュリティリスクとなります。リセット成功後、ファイルは自動的に削除されますが、手動で削除することも可能です。リセットが必要な時のみファイルを配置してください。

### Q: 複数のユーザーがいる環境で誰かがリセットファイルを配置したらどうなりますか？

A: PCへの物理的なアクセス権限を持つユーザーなら誰でもパスワードをリセットできます。機密性の高い環境では、PCへのアクセス制御を適切に行ってください。

## セキュリティベストプラクティス

1. **初期パスワードは必ず変更する**
   - デフォルトパスワード「admin123」のまま運用しないでください

2. **強力なパスワードを使用する**
   - 8文字以上
   - 大文字、小文字、数字、記号を組み合わせる
   - 辞書に載っていない文字列

3. **パスワードを安全に管理する**
   - パスワード管理ツールの使用を推奨
   - 紙に書いて保管する場合は、金庫など安全な場所に保管

4. **PC自体のセキュリティを確保する**
   - Windows/macOS/Linuxのユーザーアカウントにもパスワードを設定
   - 離席時は画面をロック

## 関連ドキュメント

- [管理者機能ガイド](./ADMIN_GUIDE.md)
- [組織ホワイトリスト設定](./ORG_WHITELIST.md)
- [セキュリティ設定](./SECURITY.md)
