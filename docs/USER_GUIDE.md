# ユーザーガイド - User Guide

このアプリケーションは、OpenAI APIを使用したチャットUIです。このガイドでは、基本的な使い方を説明します。

## 目次

1. [はじめに](#はじめに)
2. [初期設定](#初期設定)
3. [チャットの使い方](#チャットの使い方)
4. [設定のカスタマイズ](#設定のカスタマイズ)
5. [会話履歴の管理](#会話履歴の管理)
6. [Vector Storeの利用](#vector-storeの利用)
7. [トラブルシューティング](#トラブルシューティング)

---

## はじめに

### 必要なもの

- OpenAI APIキー（会社から配布されたもの）
- モダンなウェブブラウザ（Chrome, Firefox, Safari, Edge推奨）

⚠️ **重要**: 会社配布のAPIキーを使用してください。個人のAPIキーは使用できない場合があります。

---

## 初期設定

### 1. Welcome画面での接続設定

初回アクセス時、またはAPIキーが設定されていない場合、Welcome画面が表示されます。

**必須項目**:

- **API Key**: 会社から配布されたOpenAI APIキー
  - 形式: `sk-proj-...` または `sk-...`
  - ⚠️ このキーは誰にも共有しないでください

**オプション項目**:

- **Base URL**: 通常は変更不要（デフォルト: `https://api.openai.com/v1`）
- **HTTP Proxy**: 社内プロキシを経由する場合のみ設定
- **HTTPS Proxy**: 同上
- **Additional Headers**: 高度な設定（通常は不要）

### 2. ストレージポリシーの選択

データの保存方法を選択できます：

| ポリシー | 説明 | 推奨度 |
|---------|------|--------|
| **Session Only** | ブラウザを閉じるとすべて削除 | 🔒 セキュリティ重視 |
| **Persistent** | ブラウザに永続的に保存 | ⚙️ 利便性重視 |
| **Encrypted** | 暗号化して保存 | ⭐ バランス推奨 |

**暗号化について**:
- Encrypted を選択した場合、パスワードの設定が必要
- パスワードを忘れると**データは復元できません**
- ブラウザのlocalStorageに保存されます

### 3. 接続テスト

1. 必要な情報を入力
2. 「接続をテスト」ボタンをクリック
3. 成功すると緑色のメッセージが表示されます
4. 「チャットを開始」ボタンで会話画面に移動

**組織ID検証**:
会社でホワイトリスト機能が有効な場合、APIキーが会社配布のものか自動的に確認されます。

---

## チャットの使い方

### 基本的なチャット

1. **会話の新規作成**
   - ダッシュボードで「+ 新しい会話」をクリック
   - または、サイドバーから既存の会話を選択

2. **メッセージの送信**
   - テキストエリアにメッセージを入力
   - `Enter`キーで送信（改行は`Shift+Enter`）
   - または「送信」ボタンをクリック

3. **応答の表示**
   - AIの応答がリアルタイムで表示されます
   - Markdownフォーマットに対応（見出し、リスト、コードブロックなど）

### 便利な機能

#### メッセージのコピー

各メッセージにマウスをホバーすると、コピーアイコンが表示されます。クリックでメッセージをクリップボードにコピーできます。

#### フォントサイズの調整

チャット画面下部のフォントサイズボタンで、文字の大きさを変更できます：
- **A-**: 小さくする
- **A+**: 大きくする
- **Reset**: デフォルトに戻す

#### ダークモード・ライトモード

サイドバー下部のテーマ切り替えボタンで、表示テーマを変更できます。

---

## 設定のカスタマイズ

### モデルの選択

設定画面（`/settings`）で使用するAIモデルを選択できます：

- **GPT-4o**: 最新の高性能モデル
- **GPT-4o-mini**: 軽量で高速
- **GPT-4-turbo**: 高性能（やや古い）
- **GPT-3.5-turbo**: 高速で経済的

### システムロール（System Role）

AIの振る舞いを定義できます。

**プリセット**:
- デフォルト: 一般的なアシスタント
- コーディング支援: プログラミングに特化
- カスタム: 独自のプロンプトを設定

**使用例**:
```
あなたは親切な日本語のアシスタントです。
丁寧な言葉遣いで、わかりやすく説明してください。
```

### パラメータの調整

高度な設定：

- **Temperature** (0.0-2.0): 応答の創造性
  - 低い（0.1-0.5）: より決定的で一貫性のある応答
  - 高い（0.8-1.5）: より創造的でバリエーション豊かな応答

- **Max Tokens**: 応答の最大長
  - デフォルト: 2048
  - 長い文章が必要な場合は増やす（例: 4096）

- **Top P** (0.0-1.0): サンプリングの多様性

---

## 会話履歴の管理

### 会話のタイトル変更

1. ダッシュボードで会話の「編集」アイコンをクリック
2. 新しいタイトルを入力
3. チェックマークで保存

### 会話の削除

1. ダッシュボードで会話の「削除」アイコンをクリック
2. 確認ダイアログで「OK」をクリック

⚠️ **注意**: 削除した会話は復元できません。

### 会話の検索

ダッシュボードの検索ボックスで、会話のタイトルや内容を検索できます。

**フィルター機能**:
- **日付**: 今日、今週、今月、それ以前
- **ソート**: 更新日時、作成日時

---

## Vector Storeの利用

Vector Storeを使用すると、ファイルベースのRAG（検索拡張生成）が可能になります。

### Vector Storeの作成

1. ダッシュボードで「Vector Stores」セクションにアクセス
2. 「+ 新しいVector Store」をクリック
3. 名前と説明を入力
4. ファイルをアップロード（PDF, テキスト、Markdown等）
5. 作成をクリック

### 会話で使用する

1. 設定画面（`/settings`）を開く
2. 「Vector Stores」セクションで使用したいVector Storeを選択
3. チャット画面でその内容に基づいた質問が可能

**使用例**:
```
Q: この文書の主要なポイントは何ですか？
A: [アップロードした文書に基づいて回答]
```

---

## トラブルシューティング

### APIキーエラー

**症状**: 「Invalid API key」エラーが表示される

**解決策**:
1. APIキーが正しくコピーされているか確認
2. 会社から配布された最新のキーか確認
3. Welcome画面で再度接続テストを実行

### 組織ID検証エラー

**症状**: 「このAPIキーは許可されていません」エラー

**原因**: 個人のAPIキーが使用されている可能性

**解決策**:
1. 会社配布のAPIキーを使用しているか確認
2. IT管理者に連絡して、組織IDがホワイトリストに登録されているか確認

### 会話が保存されない

**症状**: ブラウザを閉じると会話が消える

**原因**: ストレージポリシーが「Session Only」に設定されている

**解決策**:
1. Welcome画面を開く
2. ストレージポリシーを「Persistent」または「Encrypted」に変更
3. 再度接続テストを実行

### 応答が遅い

**原因**:
- ネットワークの問題
- 選択しているモデルが高負荷
- プロキシ設定の問題

**解決策**:
1. より軽量なモデル（GPT-4o-miniなど）を試す
2. ネットワーク接続を確認
3. プロキシ設定を確認（必要な場合のみ）

### 暗号化パスワードを忘れた

**残念ながら**: 暗号化されたデータは復元できません

**対処法**:
1. ブラウザのlocalStorageをクリア
2. 新しいパスワードで再設定
3. 以前の会話履歴は失われます

---

## ショートカットキー

| 操作 | ショートカット |
|-----|--------------|
| メッセージ送信 | `Enter` |
| 改行 | `Shift + Enter` |
| 検索フォーカス | `Ctrl + K` / `Cmd + K` |
| 新しい会話 | `Ctrl + N` / `Cmd + N` |

---

## データとプライバシー

### データの保存場所

- **ブラウザのlocalStorage**: 設定、会話履歴
- **sessionStorage**: 一時的な認証情報
- **OpenAI サーバー**: API経由で送信されたメッセージ

### データの共有

このアプリケーションは、入力されたメッセージをOpenAI APIにのみ送信します。

- ✅ OpenAI以外のサードパーティには送信されません
- ✅ 会社のサーバーには保存されません（ブラウザのみ）
- ⚠️ OpenAIのプライバシーポリシーが適用されます

### データの削除

**すべてのデータを削除する手順**:

1. ブラウザのDevTools（開発者ツール）を開く
   - Windows/Linux: `F12`
   - Mac: `Cmd + Option + I`

2. **Application**タブ → **Local Storage** を選択

3. アプリケーションのURLを選択

4. すべてのキーを削除

または、ブラウザの設定から「サイトデータをクリア」を実行してください。

---

## ヒントとベストプラクティス

### 効果的な質問の仕方

✅ **良い質問**:
```
Pythonでファイルを読み込んで、各行を処理する方法を教えてください。
エラーハンドリングも含めて、サンプルコードを示してください。
```

❌ **不明瞭な質問**:
```
ファイル処理について教えて
```

### 長い応答が必要な場合

「続きを書いて」や「詳しく説明してください」と追加で質問すると、さらに詳細な回答が得られます。

### コンテキストの活用

同じ会話内では、以前のメッセージの内容を覚えています。関連する質問を続けることで、より深い議論が可能です。

---

## サポート

問題が解決しない場合は、IT部門またはヘルプデスクにお問い合わせください。

その際、以下の情報があるとスムーズです：
- 使用しているブラウザとバージョン
- エラーメッセージ（スクリーンショット）
- どのような操作をしたか

---

**バージョン**: 1.0
**最終更新**: 2025年1月
